<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>ピクセルペット☆スライム育成（種類えらべる版）</title>
<style>
  :root{
    --bg-sky:#a9d6ff;
    --bg-sky-night:#1a2240;
    --bg-ground:#6bb36b;
    --ui-dark:#222;
    --ui-light:#f7f7fb;
  }
  body{
    margin:0;
    font-family: ui-rounded, system-ui, -apple-system, "Segoe UI",
      "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif;
    background: linear-gradient(var(--bg-sky), var(--bg-sky) 60%, var(--bg-ground) 60%, var(--bg-ground));
    min-height:100svh;
    display:flex;
    align-items:center;
    justify-content:center;
    color:#1b1b1b;
  }
  .box{
    width:min(860px, 96vw);
    background:var(--ui-light);
    border:4px solid #3d3d3d;
    border-radius:16px;
    box-shadow:8px 8px 0 rgba(0,0,0,.25);
    padding:16px;
  }
  h1{ text-align:center; }

  /* スライムの見た目 */
  .slime{
    position:absolute; left:50%; bottom:20px; transform:translateX(-50%);
    width:180px; height:140px;
    border-radius:120px 120px 60px 60px;
    border:4px solid #2b6aa8;
    box-shadow: 0 8px 0 rgba(0,0,0,.2) inset;
    transition:transform .2s ease;
  }
  .slime.face::after{
    content:"●   ●\A  ＿";
    white-space: pre; font-weight:700;
    position:absolute; top:38%; left:50%; transform:translateX(-50%);
    text-align:center; font-size:22px;
  }

  .stage{ position:relative; border:3px solid #333; border-radius:12px; height:280px; background:#dff7ff; }

  .bubble{
    position:absolute; left:50%; top:18px; transform:translateX(-50%);
    background:white; color:#222; border:3px solid #333;
    border-radius:8px; padding:8px 12px; font-weight:700;
    box-shadow:4px 4px 0 rgba(0,0,0,.25);
    opacity:0; transition:opacity .25s ease; pointer-events:none;
  }
  .bubble.show{ opacity:1; }

  .controls{ display:grid; grid-template-columns: repeat(2,1fr); gap:10px; margin-top:10px; }
  .btn{ border:3px solid #333; border-radius:10px; padding:10px; font-weight:700; background:white; }

  /* 選択画面のスタイル */
  #selectScreen{
    text-align:center;
  }
  .slime-choice{
    display:inline-block; width:80px; height:70px; border:3px solid #333;
    border-radius:50%; margin:10px; cursor:pointer;
  }
  .blue{ background:#5bd1ff; }
  .green{ background:#7effaf; }
  .red{ background:#ff7b7b; }
</style>
</head>
<body>
<main class="box" id="game">
  <h1>ピクセルペット ☆ スライム育成</h1>

  <!-- スライムをえらぶ画面 -->
  <section id="selectScreen">
    <p>どのスライムを育てる？</p>
    <div>
      <div class="slime-choice blue" data-type="blue" title="あおスライム"></div>
      <div class="slime-choice green" data-type="green" title="みどりスライム"></div>
      <div class="slime-choice red" data-type="red" title="あかスライム"></div>
    </div>
    <p style="font-size:14px;">※クリックしてはじめよう</p>
  </section>

  <!-- ゲーム画面 -->
  <section id="mainGame" style="display:none;">
    <section class="stage">
      <div id="slime" class="slime face"></div>
      <div id="bubble" class="bubble">こんにちは！</div>
    </section>
    <section class="controls">
      <button id="btn-feed" class="btn">🍽 ごはん</button>
      <button id="btn-play" class="btn">🎲 あそぶ</button>
    </section>
  </section>
</main>

<script>
"use strict";

/* ここでは「スライムの種類をえらべる」ようにしています。
   小学生でもわかるように、動きを説明していきます。 */

/* --- ゲームに使う変数 --- */
const SAVE_KEY = "pixelpet_slime_v3";

/* スライムの状態（こうげんち・げんきなど）を保存するための入れもの */
const state = {
  type: "blue",   // スライムの種類（blue / green / red）
  hunger: 70,
  fun: 70
};

/* ページ内の場所を見つけるための関数 */
function byId(id){
  return document.getElementById(id);
}

/* バブル（ふきだし）に言葉を出す関数 */
let talkTimer = 0;
function say(message){
  const b = byId("bubble");
  b.textContent = message;
  b.classList.add("show");
  if(talkTimer){ clearTimeout(talkTimer); }
  talkTimer = setTimeout(hideBubble, 1800);
}
function hideBubble(){
  const b = byId("bubble");
  b.classList.remove("show");
}

/* --- スライムの色を変える関数 --- */
function setSlimeColor(){
  const s = byId("slime");
  if(state.type === "blue"){ s.style.background = "#5bd1ff"; }
  if(state.type === "green"){ s.style.background = "#7effaf"; }
  if(state.type === "red"){ s.style.background = "#ff7b7b"; }
}

/* --- ごはんボタンを押したとき --- */
function onClickFeed(){
  state.hunger += 10;
  if(state.hunger > 100){ state.hunger = 100; }
  say("もぐもぐ！おいしい～ (" + state.hunger + ")");
}

/* --- あそぶボタンを押したとき --- */
function onClickPlay(){
  state.fun += 10;
  if(state.fun > 100){ state.fun = 100; }
  say("たのしいね！ (" + state.fun + ")");
}

/* --- スライムの選択画面 --- */
function bindSelectScreen(){
  const choices = document.getElementsByClassName("slime-choice");
  for(let i=0; i<choices.length; i++){
    choices[i].addEventListener("click", function(){
      state.type = this.getAttribute("data-type");
      saveState();
      startGame();
    });
  }
}

/* --- スライムを表示してゲームをはじめる --- */
function startGame(){
  byId("selectScreen").style.display = "none";
  byId("mainGame").style.display = "block";
  setSlimeColor();
  say("こんにちは！ぼくは" + state.type + "スライムだよ！");
  byId("btn-feed").addEventListener("click", onClickFeed);
  byId("btn-play").addEventListener("click", onClickPlay);
}

/* --- データをセーブする --- */
function saveState(){
  try{
    localStorage.setItem(SAVE_KEY, JSON.stringify(state));
  }catch(e){}
}

/* --- データをよみこむ --- */
function loadState(){
  try{
    const raw = localStorage.getItem(SAVE_KEY);
    if(!raw){ return false; }
    const data = JSON.parse(raw);
    if(data.type){ state.type = data.type; }
    return true;
  }catch(e){ return false; }
}

/* ページがひらかれたときの動き */
function init(){
  const loaded = loadState();
  bindSelectScreen();
  if(loaded){
    // すでにスライムをえらんでいたら、そのまま再開
    startGame();
  }
}

init();
</script>
</body>
</html>
